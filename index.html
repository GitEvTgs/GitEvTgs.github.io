<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Галерея изображений из текущей директории</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background-color: #f6f8fa;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e1e4e8;
        }
        
        h1 {
            color: #0366d6;
            margin-bottom: 10px;
        }
        
        .description {
            color: #586069;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .image-item {
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .image-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .image-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
            border-bottom: 1px solid #e1e4e8;
        }
        
        .image-info {
            padding: 15px;
        }
        
        .image-name {
            font-weight: 600;
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        .image-size {
            font-size: 12px;
            color: #586069;
        }
        
        .loading, .error, .no-images {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        
        .loading {
            color: #0366d6;
        }
        
        .error {
            color: #cb2431;
        }
        
        .no-images {
            color: #586069;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e4e8;
            color: #586069;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .gallery-container {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
                gap: 15px;
            }
            
            body {
                padding: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .gallery-container {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Галерея изображений</h1>
        <p class="description">Все изображения из текущей директории GitHub</p>
    </header>
    
    <main>
        <div id="gallery" class="gallery-container">
            <!-- Изображения будут добавлены сюда -->
        </div>
        
        <div id="loading" class="loading">
            <p>Загрузка изображений...</p>
        </div>
        
        <div id="error" class="error" style="display: none;">
            <p>Ошибка при загрузке изображений. Проверьте консоль браузера для деталей.</p>
        </div>
        
        <div id="no-images" class="no-images" style="display: none;">
            <p>В этой директории не найдено изображений.</p>
        </div>
    </main>
    
    <footer>
        <p>Галерея изображений GitHub &copy; <span id="current-year"></span></p>
    </footer>

    <script>
        // Устанавливаем текущий год в футере
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Массив с поддерживаемыми форматами изображений
        const imageExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'svg', 'bmp', 'tiff'];
        
        // Функция для получения списка файлов из текущей директории
        async function getFilesFromDirectory() {
            try {
                // Получаем текущий путь
                const currentPath = window.location.pathname;
                const pathParts = currentPath.split('/');
                // Удаляем имя файла index.html из пути
                const directoryPath = pathParts.slice(0, -1).join('/');
                
                // Пробуем получить файлы из текущей директории
                // Этот метод работает только если у вас есть доступ к GitHub API
                // или если у вас есть предопределенный список файлов
                
                // Вместо этого, мы будем использовать альтернативный подход:
                // 1. Попробуем загрузить файлы, которые мы знаем (если есть)
                // 2. Или создадим ручной список изображений
                
                // Создадим массив изображений, которые мы знаем в директории
                // Этот массив нужно будет обновить вручную или через скрипт
                const knownImages = [
                    // Добавьте здесь имена ваших файлов изображений
                    // Пример: "example.jpg", "photo.png"
                ];
                
                // Если известных изображений нет, попробуем найти их автоматически
                if (knownImages.length === 0) {
                    return findImagesAutomatically();
                }
                
                return knownImages;
                
            } catch (error) {
                console.error('Ошибка при получении файлов:', error);
                throw error;
            }
        }
        
        // Функция для автоматического поиска изображений
        async function findImagesAutomatically() {
            try {
                // Получаем текущий URL
                const currentUrl = window.location.href;
                const baseUrl = currentUrl.substring(0, currentUrl.lastIndexOf('/') + 1);
                
                // Пробуем получить список файлов через GitHub API, если мы на GitHub Pages
                if (currentUrl.includes('github.io')) {
                    // Это GitHub Pages
                    const repoPath = currentUrl.split('.github.io/')[1] || '';
                    const userRepo = currentUrl.match(/https?:\/\/([^\.]+)\.github\.io/)[1];
                    
                    if (repoPath) {
                        const apiUrl = `https://api.github.com/repos/${userRepo}/${repoPath.split('/')[0]}/contents/${repoPath}`;
                        
                        try {
                            const response = await fetch(apiUrl);
                            if (response.ok) {
                                const files = await response.json();
                                const imageFiles = files.filter(file => {
                                    const extension = file.name.split('.').pop().toLowerCase();
                                    return imageExtensions.includes(extension);
                                }).map(file => file.name);
                                
                                return imageFiles;
                            }
                        } catch (apiError) {
                            console.log('GitHub API недоступен, используем альтернативный метод');
                        }
                    }
                }
                
                // Альтернативный метод: пытаемся загрузить изображения по предполагаемым именам
                // Этот метод не гарантирует успех, но может работать для небольших проектов
                const testImages = [];
                
                // Тестовый список возможных имен изображений
                const testNames = [
                    'image', 'photo', 'img', 'picture', 'sample', 'example',
                    '01', '02', '03', '1', '2', '3', 'a', 'b', 'c'
                ];
                
                // Для каждого тестового имени и расширения проверяем, существует ли файл
                for (const name of testNames) {
                    for (const ext of imageExtensions) {
                        const imageUrl = `${baseUrl}${name}.${ext}`;
                        const exists = await checkImageExists(imageUrl);
                        if (exists) {
                            testImages.push(`${name}.${ext}`);
                        }
                    }
                }
                
                return testImages;
                
            } catch (error) {
                console.error('Ошибка при автоматическом поиске изображений:', error);
                return [];
            }
        }
        
        // Функция для проверки существования изображения
        async function checkImageExists(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                return response.ok;
            } catch (error) {
                return false;
            }
        }
        
        // Функция для отображения изображений
        async function displayImages() {
            const galleryElement = document.getElementById('gallery');
            const loadingElement = document.getElementById('loading');
            const errorElement = document.getElementById('error');
            const noImagesElement = document.getElementById('no-images');
            
            try {
                // Получаем список изображений
                const imageFiles = await getFilesFromDirectory();
                
                // Скрываем элемент загрузки
                loadingElement.style.display = 'none';
                
                if (imageFiles.length === 0) {
                    // Если изображений нет, показываем сообщение
                    noImagesElement.style.display = 'block';
                    return;
                }
                
                // Получаем базовый URL для изображений
                const currentUrl = window.location.href;
                const baseUrl = currentUrl.substring(0, currentUrl.lastIndexOf('/') + 1);
                
                // Отображаем каждое изображение
                imageFiles.forEach((imageName, index) => {
                    const imageUrl = `${baseUrl}${imageName}`;
                    
                    // Создаем элемент для изображения
                    const imageItem = document.createElement('div');
                    imageItem.className = 'image-item';
                    imageItem.innerHTML = `
                        <img src="${imageUrl}" alt="${imageName}" loading="lazy" id="img-${index}">
                        <div class="image-info">
                            <div class="image-name">${imageName}</div>
                            <div class="image-size">Загрузка информации о размере...</div>
                        </div>
                    `;
                    
                    galleryElement.appendChild(imageItem);
                    
                    // Получаем информацию о размере изображения
                    getImageSize(imageUrl, index);
                });
                
            } catch (error) {
                console.error('Ошибка при отображении изображений:', error);
                loadingElement.style.display = 'none';
                errorElement.style.display = 'block';
            }
        }
        
        // Функция для получения размера изображения
        async function getImageSize(imageUrl, index) {
            try {
                const img = new Image();
                img.onload = function() {
                    const sizeElement = document.querySelector(`#img-${index}`).closest('.image-item').querySelector('.image-size');
                    const sizeInKB = (this.naturalWidth * this.naturalHeight * 3 / 1024).toFixed(2); // Примерный расчет
                    sizeElement.textContent = `${this.naturalWidth} × ${this.naturalHeight} пикселей (~${sizeInKB} KB)`;
                };
                img.src = imageUrl;
            } catch (error) {
                console.error(`Ошибка при получении размера изображения ${imageUrl}:`, error);
            }
        }
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            displayImages();
        });
        
        // Добавляем инструкции для пользователя в консоль
        console.log('Инструкция по использованию:');
        console.log('1. Для автоматического отображения изображений, добавьте их имена в массив knownImages в коде JavaScript');
        console.log('2. Или используйте GitHub Pages с правильной структурой репозитория для автоматического обнаружения файлов');
        console.log('3. Для ручного управления добавьте имена файлов в массив knownImages ниже:');
    </script>
</body>
</html>
